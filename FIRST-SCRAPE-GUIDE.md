# 🚀 首次数据采集操作指南

## ✅ 系统状态检查

### 1. 开发服务器状态
- ✅ 开发服务器已启动（运行在后台）
- 🌐 访问地址：http://localhost:3000

### 2. 数据库同步状态
- ✅ Prisma 客户端已生成
- ✅ DataSource 模型已同步到数据库

### 3. 采集源初始化状态
- ✅ Polymarket 采集源已注册
- 📊 采集源 ID: `8b7e8aab-048f-4b62-a9a8-7f64869751b7`
- 📊 状态: `ACTIVE`
- 📊 权重系数: `1.0`

### 4. API 状态
- ✅ `/api/admin/scrapers` 接口正常响应
- ✅ 已返回采集源列表数据

---

## 🎯 操作步骤：触发第一次全网数据采集

### 步骤 1：登录管理后台

1. 打开浏览器，访问：**http://localhost:3000/admin/login**
2. 点击 **"Sign in as Admin"** 按钮
3. 使用您的 Google 管理员账号登录

### 步骤 2：进入指标管理页面

登录成功后，您会看到左侧导航栏。找到以下菜单项：

**路径**：左侧导航栏 → **"市场运营"** 分组 → **"全局指标管理"**

或者直接访问 URL：**http://localhost:3000/admin/stats**

### 步骤 3：查看采集源监控表格

在指标管理页面的**顶部**，您会看到一个 **"数据采集源监控"** 表格，显示：

- **采集源名称**：Polymarket
- **状态**：激活（绿色）
- **最后同步时间**：从未同步
- **采集数量**：0
- **权重系数**：1.00x
- **操作**：手动运行按钮

### 步骤 4：触发第一次采集

1. 找到 **Polymarket** 行
2. 点击右侧的 **"手动运行"** 按钮（带有播放图标 ▶️）
3. 按钮会变为 **"抓取中..."** 并显示加载动画
4. 等待采集完成（通常需要 10-30 秒，取决于网络速度）

### 步骤 5：查看采集结果

采集完成后：

1. **状态更新**：
   - "最后同步时间" 会更新为 "刚刚" 或具体时间
   - "采集数量" 会显示本次采集到的市场数量

2. **查看采集到的数据**：
   - 访问：http://localhost:3000/admin/markets/review
   - 这里会显示所有新采集的待审核市场（状态为 PENDING）

3. **查看统计数据更新**：
   - 访问：http://localhost:3000/data
   - 右侧的统计指标会根据采集结果实时更新

---

## 📋 预期结果

### 采集成功后，您应该看到：

1. **采集源监控表格**：
   - ✅ 最后同步时间：显示 "刚刚" 或具体时间
   - ✅ 采集数量：显示采集到的市场数量（例如：50、100 等）

2. **待审核市场列表**（`/admin/markets/review`）：
   - ✅ 显示新采集的市场列表
   - ✅ 每个市场状态为 "待审核"（PENDING）
   - ✅ 可以点击 "审核通过" 或 "永久拒绝"

3. **数据中心页面**（`/data`）：
   - ✅ 统计指标会根据采集源数据实时计算
   - ✅ 例如："进行中事件" 数量会增加

---

## ⚠️ 注意事项

1. **网络连接**：确保服务器可以访问 Polymarket API（https://gamma-api.polymarket.com）

2. **采集时间**：首次采集可能需要 10-30 秒，请耐心等待

3. **数据量**：默认采集 100 个市场，如果网络较慢可能需要更长时间

4. **错误处理**：如果采集失败，状态会显示为 "错误"，并显示具体错误信息

---

## 🔄 后续操作

### 设置定时自动采集

可以设置定时任务定期运行采集：

1. **使用 Vercel Cron Jobs**（如果部署在 Vercel）：
   - 配置 `vercel.json` 定时调用 `/api/cron/sync-polymarket`

2. **使用服务器 Cron**：
   - 设置 cron job 定期执行采集脚本

3. **手动采集**：
   - 随时在指标管理页面点击 "手动运行" 按钮

---

## 🆘 遇到问题？

### 如果采集失败：

1. **检查 API 响应**：
   - 打开浏览器开发者工具（F12）
   - 查看 Network 标签
   - 检查 `/api/admin/scrapers/Polymarket/run` 的响应

2. **查看服务器日志**：
   - 查看运行 `npm run dev` 的终端输出
   - 查找错误信息

3. **验证网络连接**：
   ```bash
   curl https://gamma-api.polymarket.com/markets?closed=false&limit=10
   ```

4. **重新初始化采集源**：
   ```bash
   npx tsx scripts/init-data-sources.ts
   ```

---

## 📞 快速访问链接

- 🏠 **管理后台首页**：http://localhost:3000/admin/dashboard
- 📊 **指标管理页面**：http://localhost:3000/admin/stats
- 🔍 **待审核市场**：http://localhost:3000/admin/markets/review
- 📈 **数据中心**：http://localhost:3000/data
- ⚙️ **API 测试**：http://localhost:3000/api/admin/scrapers

---

**祝您首次采集顺利！** 🎉
